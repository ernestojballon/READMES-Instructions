# Single-spa adding standalone config-server
- Make sure we have this dev-dependencies

```bash
     npm install -D html-webpack-plugin single-spa webpack-cli webpack-config-single-spa webpack-merge 
```
- Add `standalone-server.config.ts` this is the webpack configuration for the server

```js
const { merge } = require('webpack-merge');
const singleSpaDefaults = require('webpack-config-single-spa');
const HtmlWebpackPlugin = require('html-webpack-plugin');
const path = require('path');

const entryDir = path.resolve(__dirname, `./src/standalone.config.js`);

module.exports = (webpackConfigEnv, argv) => {
  const orgName = 'CompanyName';
  const defaultConfig = singleSpaDefaults({
    orgName,
    projectName: 'standalone-config',
    webpackConfigEnv,
    argv,
    disableHtmlGeneration: true,
  });
  return merge(defaultConfig, {
    entry: entryDir,
    // modify the webpack config however you'd like to by adding to this object
    plugins: [
      new HtmlWebpackPlugin({
        inject: false,
        template: 'src/index.ejs',
        templateParameters: {
          isLocal: webpackConfigEnv && webpackConfigEnv.isLocal,
          orgName,
        },
      }),
    ],
  });
};

```

Webpack uses the `standalone-config.js` file to configure the server.

- Adding `standalone-config.js`, inside src folder

```js
import { registerApplication, start } from 'single-spa';

registerApplication({
  name: 'mf-one',
  app: () => System.import('@ross:mf-one'),
  activeWhen: ['/'],
});

start({
  urlRerouteOnly: true,
});

```

- In the same src folder we add the `index.ejs` which is the template for the index.html file generated by the webpack.

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Standaloone Config</title>
  <script src="https://cdn.jsdelivr.net/npm/regenerator-runtime@0.13.7/runtime.min.js"></script>

  <meta name="importmap-type" content="systemjs-importmap" />
  <script type="systemjs-importmap">
    {
      "imports": {
        "single-spa": "https://cdn.jsdelivr.net/npm/single-spa@5.9.0/lib/system/single-spa.min.js"
      }
    }
  </script>
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/single-spa@5.9.0/lib/system/single-spa.min.js" as="script">
  <!-- Angular Theme for Standalone -->
  <link href="https://unpkg.com/@angular/material/prebuilt-themes/indigo-pink.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'> <!-- Include font first -->
  <style>
    body {
          font-family: Roboto, 'Helvetica Neue', sans-serif;
          margin: 0;
          padding: 30px;
        }

        html,
        body {
          height: 100%;
        }
  </style>
  <script type="systemjs-importmap">
    {
      "imports": {
        "@ross/standalone-config": "//localhost:9002/ross-standalone-config.js",
        "@ross:mf-one": "//localhost:4202/main.js",
        "@ross:mf-utility": "//localhost:5202/main.js"
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/zone.js@0.11.3/dist/zone.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/import-map-overrides@2.2.0/dist/import-map-overrides.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/systemjs@6.8.3/dist/system.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/systemjs@6.8.3/dist/extras/amd.js"></script>
</head>
<body>
  <noscript>
    You need to enable JavaScript to run this app.
  </noscript>
  <main></main>
  <script>
    System.import('@ross/standalone-config');
    System.import('single-spa').then(function (singleSpa) {
      // Any route different that does not start with '/one' will be redirected to '/one'
      if (!window.location.pathname.startsWith('/one')) {
        singleSpa.navigateToUrl('/one');
      }
    });
  </script>
  <import-map-overrides-full dev-libs></import-map-overrides-full>
</body>
</html>

```

- Add script to package.json

```sh
"start:standalone:server": "webpack serve --port 9002 --config standalone-server.config.js"
```
